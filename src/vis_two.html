<head xmlns="http://www.w3.org/1999/html">
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <title>Question 1</title>
</head>

<body style="background-color: #121212;padding-left: 10%;color: #ffffff; font-family:verdana">
<div id="my_info">
    <b>Name: </b> Jack Geraghty  </br>
    <b>Student Number: </b> 16384181 </br>
    <b>Email: </b> jack.geraghty@ucdconnect.ie </br>
    <b>Dataset: </b> Spotify</br>
</div>
<br/><br/><br/>
<div id="vis" style=" width: 90%;height: 65%"></div>
<br/><br/><br/><br/><br/><br/>
<br/><br/><br/>


<div id="answer" style="background-color: #121212;width: 90%">
    <u><b>Question: </b></u>
    <u><b>Description: </b></u>
    <u><b>Insight: </b></u>
    <u><b>Design Considerations: </b></u>
    <u><b>Data Filtering/Aggregation/Transforms: </b></u>

</div>

<script type="text/javascript">

    window.addEventListener("resize", visualize);
    visualize();

    function visualize() {
        let w = Math.floor(window.innerWidth * 0.8);
        let h = Math.floor(window.innerHeight * 0.75);
        console.log(w);
        console.log(h);
        const data = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "data": {
                "url": "../data/q2.csv",
                "format": {"type": "csv"}
            },
            "width" : 600,
            "height" : 500,
            "selection": {
                "spt": {
                    "type": "single",
                    "on": "click",
                    "fields": ["track_artist"],
                    "bind": {
                        "input": "select",
                        "options": ["Ed Sheeran", "Maroon 5", "Zara Larsson", "The Chainsmokers", "Katy Perry",
                            "Sam Feldt", "Avicii", "Shawn Mendes", "Ellie Goulding", "Martin Garrix"]
                    }
                }
            },
            "transform": [
                {"filter" : "datum.feature != 'instrumentalness' "},
                {"filter" :  "datum.track_popularity > 0"}
            ],

            "mark": {"type": "circle"},
            "encoding": {
                "facet": {"field": "feature", "type": "ordinal", "title": "Musical Feature", "columns": 3},
                "x": {"field": "track_popularity", "type": "quantitative", "title": "Track Popularity",
                "scale": {"domain": [0, 100]}},
                "y": {"field": "feature_value", "type": "quantitative", "title": "Median Feature Value",
                    "scale": {"domain": [0, 1]}},
                "color": {
                    "condition": {
                        "selection": "spt"},
                    "value": "grey"
                },
                "opacity": {
                    "condition": {
                        "selection": "spt",
                        "value": 1,

                    },
                    "value": 0.1
                }
            }


        };
        vegaEmbed("#vis", data);
    }
</script>
</body>